{% extends 'template.html' %}

{% block import %}
<link rel="stylesheet" href="/static/bootstrap-table/dist/bootstrap-table.min.css">
<script type = "text/javascript" src="{{ url_for('static', filename = 'bootstrap-table/dist/bootstrap-table.js') }}"></script>
<script type = "text/javascript" src="{{ url_for('static', filename = 'bootstrap-table/dist/locale/bootstrap-table-zh-CN.min.js') }}"></script>
<style>
    /** bootstrap table 工具栏 **/
    .fixed-table-toolbar{
        display: flex;
        float: right;
    }
    .search-input {
        border-radius: 4px!important;
    }
</style>
{% endblock %}

{% block content_head %} 查看项目 {% endblock %}
{% block content_inner %}
<div>
    <h1>sss</h1>
</div>
<div style="font-weight: bolder;margin-bottom: -40px">
    <span>模型</span>
    <span class="badge">{{ project_info.model_list | length }}</span>
</div>
<div id="toolbar">
    <a href="#"><button class="btn btn-default" id="create_model">
        <i class="fa fa-plus-circle" aria-hidden="true"></i>
        &nbsp;新建模型
    </button></a>
</div>
<table id="model-list" class="table table-striped table-bordered table-hover" style="display: table;"></table>
<script>
    let project_data = {{ project_info | safe }};
    let nav_list = ['首页', '项目', '查看项目'];
    $(function () {
        load_nav(nav_list);
        load_table(project_data['model_list']);
    });
    function load_table(data) {
        let tableData = new Array();
        for(let i = 0; i < data.length; i++){
            tableData[i] = new Object();
            tableData[i].name = data[i].name;
            tableData[i].type = data[i].type;
            tableData[i].file = data[i].file;
            tableData[i].version = data[i].version;
            tableData[i].description = data[i].description;
            tableData[i].operation = data[i].id;
        }
        let tableColumns = [
            {field: 'name', title: '名称', sortable: true},
            {field: 'type', title: '类型', sortable: true},
            {field: 'file', title: '文件', sortable: true},
            {field: 'version', title: '版本', sortable: true},
            {field: 'description', title: '描述', sortable: true},
            {field: 'operation', title: '操作',
                formatter: function(value,row,index){
                    let viewBtn   = '<button type="button" class="btn btn-success view">查看</button>';
                    let editBtn   = '<button type="button" class="btn btn-info" data-toggle="modal" data-target="#edit-modal">修改</button>';
                    let deleteBtn = '<button type="button" class="btn btn-danger" data-toggle="modal" data-target="#delete-confirm-modal">删除</button>';
                    return viewBtn +'&nbsp;'+ editBtn +'&nbsp;'+ deleteBtn;
                }
            }
        ];
        $('#model-list').bootstrapTable('destroy');
        $('#model-list').bootstrapTable({
            columns: tableColumns,
            data: tableData,
            width: 10,
            method: 'post',
            dataType: 'json',
            toolbar: '#toolbar',
            pagination: true,
            maintainSelected: true,
            sidePagination: "client",
            pageNumber: 1,
            pageSize: 10,
            pageList: [5, 10, 15, 20, 25],
            minimumCountColumns: 2,
            clickToSelect: true,
            search: true,
            sortStable: true,
            showToggle: true,
            showColumns: true,
            showFullscreen: true,
            toolbar:'#toolbar',//工具栏
            buttonsAlign: "right",
        });
    }
</script>
{% endblock %}